//=============================================================================
// ■ asm.cpp
//-----------------------------------------------------------------------------
//   不得不用（AT&T）汇编编写的函数，但也许有直接写在外部NASM文件中的方法。
//=============================================================================

namespace ASM {
	//-------------------------------------------------------------------------
	// ● CPU挂起
	//-------------------------------------------------------------------------
	inline void hlt() {
		__asm__ ("hlt");
	}

	//-------------------------------------------------------------------------
	// ● 端口写入
	//-------------------------------------------------------------------------
	inline void out8(type_port port, uint8_t value) {
		asm volatile("outb %1, %0" : : "dN" (port), "a" (value));
	}

	//-------------------------------------------------------------------------
	// ● 端口读出
	//-------------------------------------------------------------------------
	inline uint8_t in8(type_port port) {
		uint8_t r;
		asm volatile("inb %1, %0" : "=a" (r) : "dN" (port));
		return r;
	}
	inline uint16_t in16(type_port port) {
		uint16_t r;
		asm volatile("inw %1, %0" : "=a" (r) : "dN" (port));
		return r;
	}
}
